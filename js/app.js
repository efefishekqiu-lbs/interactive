let games = {
    ["streetnheists"]: {
        label: "Streets n Heists",
        thumbnail: "/assets/gamepics/snh1.png",
        video: "/assets/videos/streetsnheistgameplay.mp4",
        logo: "./assets/logos/streetsnheistlogo.png",
        supportedPlatforms: {
            ["pc"]: false,
            ["ps4"]: true,
            ["xbox"]: true,
        },
        contents: {
            ["/assets/videos/streetsnheistgameplay.mp4"]: 1,
            ["/assets/gamepics/snh1.png"]: 2,
            ["/assets/gamepics/snh2.png"]: 3,
            ["/assets/gamepics/snh3.png"]: 4,
            ["/assets/gamepics/snh4.png"]: 5,
            ["/assets/gamepics/snh5.png"]: 6,
            ["/assets/gamepics/snh6.png"]: 7,
        },
        depends: {
            ["Platform"]: "Windows 10/11",
            ["Utvecklare"]: "Kosta/Adis/Leon",
            ["Tillg칛ngligt"]: "26-02-27",
            ["Marknadsf칬ringsinneh친ll"]: "Ja",            
        },
        tags: {
            ["SHOOTING"]: true,
            ["2D"]: true,
        },
        description: "Kliv in i en 칬ppen stad inspirerad av klassiska top down actionspel d칛r tempot 칛r h칬gt och faran lurar runt varje h칬rn Du tar rollen som en or칛dd karakt칛r som f칬rs칬ker 칬verleva i en brutal stad fylld av brott kaos och st칛ndiga polisinsatser Utforska gatorna ta dig an uppdrag samla vapen och fly fr친n polisen i intensiva biljakter och explosiva konfrontationer Ju mer uppm칛rksamhet du v칛cker desto h친rdare blir jakten Kan du h친lla dig steget f칬re lagen och skapa ditt eget namn i stadens undre v칛rld",
        faq: `
            <p><strong>What is Street N Heists?</strong></p>
            <br>
            <p>Street N Heists is a fast-paced top-down action game developed and published by Interactive. Set in a crime-filled open city, players take on the role of an ambitious outlaw completing dangerous jobs, escaping intense police chases, and building their reputation in the underground world.</p>
            <br>
            <p><strong>When will Street N Heists be released?</strong></p>
            <br>
            <p>Street N Heists is scheduled for release in 2026. The exact launch date will be announced soon on our official channels.</p>
            <br>
            <p><strong>On which platforms will Street N Heists be available?</strong></p>
            <br>
            <p>Street N Heists will be available on PC at launch. Additional platform releases may be announced at a later date.</p>
            <br>
            <p><strong>Does Street N Heists support controller input?</strong></p>
            <br>
            <p>Yes. Street N Heists supports both keyboard and mouse as well as compatible controllers on PC.</p>
            <br>
            <p><strong>Is there multiplayer in Street N Heists?</strong></p>
            <br>
            <p>At launch, Street N Heists is designed as a single-player experience. Future updates may expand gameplay features.</p>
            <br>
            <p><strong>Will there be post-launch content?</strong></p>
            <br>
            <p>Interactive plans to support Street N Heists with updates, gameplay improvements, and additional content after release. More details will be shared closer to launch.</p>
            <br>
            <p><strong>Where can I purchase Street N Heists?</strong></p>
            <br>
            <p>Street N Heists will be available through major digital PC storefronts. More information will be provided prior to release.</p>
            <br>
            <p><strong>Where can I follow updates about the game?</strong></p>
            <br>
            <p>You can follow the latest news and announcements from Interactive on our official website and social media channels.</p>
        `,
    },
    ["parryvsgod"]: {
        label: "Parry Vs God",
        thumbnail: "/assets/gamepics/pvg1.png",
        video: "/assets/videos/parryvsgodgameplay.mp4",
        logo: "./assets/logos/parryvsgodlogo.png",
        supportedPlatforms: {
            ["pc"]: true,
            ["ps4"]: true,
            ["xbox"]: true,
        },
        contents: {
            ["/assets/videos/parryvsgodgameplay.mp4"]: 1,
            ["/assets/gamepics/pvg1.png"]: 2,
            ["/assets/gamepics/pvg2.png"]: 3,
            ["/assets/gamepics/pvg3.png"]: 4,
            ["/assets/gamepics/pvg4.png"]: 5,
            ["/assets/gamepics/pvg5.png"]: 6,
            ["/assets/gamepics/pvg6.png"]: 7,
        },
        depends: {
            ["Platform"]: "Windows 10/11",
            ["Utvecklare"]: "Missam/Sigge",
            ["Tillg칛ngligt"]: "25-02-27",
            ["Marknadsf칬ringsinneh친ll"]: "Ja",            
        },
        tags: {
            ["OPEN WORLD"]: true,
            ["3D"]: true,
        },
        description: "Kliv in i en episk 칬ppen v칛rld d칛r endast de modigaste krigarna 칬verlever Varje boss som dyker upp 칛r en unik utmaning som kr칛ver skicklighet snabbhet och strategi Som spelare tar du rollen som en m칛stare i parry och attack, redo att m칬ta fruktansv칛rda gudar i intensiva strider Utforska v칛rlden, uppt칛ck hemliga platser och f칬rbered dig p친 sv친ra konfrontationer Ju fler bossar du besegrar desto m칛ktigare blir du Kan du bem칛stra varje gud och bli den ultimata krigaren i Parry Vs God",
        faq: `
            <p><strong>What is Parry Vs God?</strong></p>
            <br>
            <p>Parry Vs God is a fast-paced boss battle game set in a vast open world. Players take on the role of a master fighter specializing in parry and attack, facing epic gods in challenging duels to prove their skill and strategy.</p>
            <br>
            <p>When will Parry Vs God be released?</strong></p>
            <br>
            <p>Parry Vs God is scheduled for release in 2026. The exact launch date will be announced soon on our official channels.</p>
            <br>
            <p><strong>On which platforms will Parry Vs God be available?</strong></p>
            <br>
            <p>Parry Vs God will be available on PC at launch. Console releases may be announced at a later date.</p>
            <br>
            <p><strong>Does Parry Vs God support controller input?</strong></p>
            <br>
            <p>Yes. Parry Vs God supports both keyboard and mouse as well as compatible controllers on PC.</p>
            <br>
            <p><strong>Is there multiplayer in Parry Vs God?</strong></p>
            <br>
            <p>At launch, Parry Vs God is designed as a single-player experience focused entirely on boss battles. Future updates may expand gameplay features.</p>
            <br>
            <p><strong>Will there be post-launch content?</strong></p>
            <br>
            <p>Interactive plans to support Parry Vs God with updates, additional bosses, gameplay improvements, and new open world areas after release.</p>
            <br>
            <p><strong>Where can I purchase Parry Vs God?</strong></p>
            <br>
            <p>Parry Vs God will be available through major digital PC storefronts. More information will be provided prior to release.</p>
            <br>
            <p><strong>Where can I follow updates about the game?</strong></p>
            <br>
            <p>You can follow the latest news and announcements from Interactive on our official website and social media channels.</p>
        `,        
    },
}

let currentGame = "streetnheists"
function selectGame(id) {
    if (games[id]) {
        let data = games[id];
        currentGame = id;
        $(".selected-game-platforms>img").hide()
        $.each(data.supportedPlatforms, function(k, v) {
            if (v == true) {
                $(`.selected-game-platforms>img[data-type="${k}"]`).show()
            }
        })
        $(".selected-game-name, .game-label").html(data.label)
        $(".video").attr("src", data.video)
        $(".selected-game-bg, .selected-game-profile-thumbnail").attr("src", data.thumbnail)
        $(".game-element").removeClass("game-selected")
        $(`.game-element[data-id="${id}"]`).addClass("game-selected")
        $(".slide-track>img").hide()
        $(`.slide-track>img[data-game="${id}"]`).show()
    }
}

let isHeaderMinimized = false;
window.addEventListener("scroll", () => {
    const scrollY = window.scrollY;

    if (scrollY > 50) {
        if (!isHeaderMinimized) {
            isHeaderMinimized = true;
            $("header").css({
                "position": "fixed",
                "top": "3vh",
                "left": "50%",
                "width": "85%",
                "border-radius": "15px",
                "backdrop-filter": "blur(5px)",
                "border": "1px solid hsla(0, 0%, 100%, .2)",
                "height": "50px",
                "transform": "translateX(-50%)",
                "box-shadow": "rgba(78, 78, 78, 0.173) 0px 30px 60px -12px, rgba(0, 0, 0, 0.375) 0px 18px 36px -18px"
            });
        }
    } else {
        if (isHeaderMinimized) {
            isHeaderMinimized = false;
            $("header").css({
                "position": "absolute",
                "top": "0",
                "left": "0",
                "width": "100%",
                "height": "90px",
                "border-radius": "0",
                "border": "none",
                "border-bottom": "1px solid hsla(0, 0%, 100%, .2)",
                "backdrop-filter": "none",
                "transform": "none",
                "box-shadow": "rgba(78, 78, 78, 0.173) 0px 30px 60px -12px, rgba(0, 0, 0, 0.375) 0px 18px 36px -18px"
            });
        }
    }
});

$(document).on("click", ".game-element", function () {
   selectGame($(this).attr("data-id"))
})

function logoReload() {
    let circle = $("#logo-circle");
    let x = $("#logo-x");
    let both = $("#logo-both");
    let logo = $("#logo-real");

    circle.css({ opacity: 1, transform: "scale(1.5)" });
    setTimeout(() => {
        circle.css({ transition: "all 0.35s ease", transform: "scale(0.7)" });
    }, 100);
    setTimeout(() => {
        circle.css({ transform: "scale(1.1)" });
    }, 450);
    setTimeout(() => {
        circle.css({ transform: "scale(0)", opacity: 0 });
    }, 750);
    setTimeout(() => {
        x.css({ opacity: 1, transform: "scale(1.2)" });
    }, 850);
    setTimeout(() => {
        x.css({ transition: "all 0.35s ease", transform: "scale(0.7)" });
    }, 1000);
    setTimeout(() => {
        x.css({ transform: "scale(1.06) rotate(180deg)" });
    }, 1300);
    setTimeout(() => {
        x.css({ opacity: 0, transform: "scale(0)" });
        both.css({
            opacity: 1,
            transform: "scale(0.4)",
            transition: "all 0.35s ease"
        });
    }, 1650);
    setTimeout(() => {
        both.css({ transform: "scale(1.1)" });
    }, 1750);
    setTimeout(() => {
        both.css({ transform: "scale(0.95)" });
    }, 2050);
    setTimeout(() => {
        both.css({ opacity: "0" });
        setTimeout(() => {
            logo.css({
                opacity: 1,
                transform: "scale(1.01)" 
            });
        }, 100);
    }, 2300);
}

$(document).ready(function () {
    logoReload()
    $('.video')[0].play(); 
    selectGame("streetnheists")
    // openGamePage("streetnheists")
});


$(document).on("click", ".faq-wrapper-item", function () {
    if ($(this).hasClass("faq-wrapper-item-active")) {
        $(this).removeClass("faq-wrapper-item-active");
    } else {
        $(".faq-wrapper-item").removeClass("faq-wrapper-item-active");
        $(this).addClass("faq-wrapper-item-active");
    }
});

let currentOpenedGame = "null";
function openGamePage(id) {
    if (games[id]) {
        currentOpenedGame = id;
        $("body").css("overflow-y", "hidden")
        selectGamepageNavbar("oversikt")
        $("header").hide()
        let data = games[id];
        $(".gamepage-contentScreen>video").hide()
        $(".gamepage-rightHandSide-logo").attr("src", data.logo)
        $(".gamepage-contentScreen>img").attr("src", data.thumbnail)
        $(".gamepage-footerWrapper-contents").html("")
        $.each(data.contents, function(k, v) {
            let content = `<img src="${k}" alt="${k} content">`
            if (isUrlVideo(k) == true) {
                content = `<video class="as" src="${k}" muted playsinline paused preload="metadata"></video>
                <svg class="startVideoShowcase" stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80L0 432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"></path></svg>
                <svg class="pauseVideoShowcase" stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M96 448h106.7V64H96v384zM309.3 64v384H416V64H309.3z"></path></svg>
                `
            }
            $(".gamepage-footerWrapper-contents").append(`
                <div class="gamepage-footerWrapper-contents-box" data-id="${v}">
                    ${content}
                </div>
            `)
        })
        $(".gamepage-tags-wrapper").html("")
        $.each(data.tags, function(k, v) {
            $(".gamepage-tags-wrapper").append(`
                <div class="gamepage-tags-wrapper-tag">${k}</div>
            `)
        })
        $(".gamepage-description").html(data.description)
        $(".gamepage-faq").html(data.faq)
        $(".gamepage-dependsWrapper").html("")
        $.each(data.depends, function(k, v) {
            $(".gamepage-dependsWrapper").append(`
                <div class="gamepage-dependsWrapper-box">
                    <h1>${k}</h1>
                    <h2>${v}</h2>
                </div>    
            `)
        })
        $(".gamepage-dependsWrapper").append(`
            <div class="gamepage-dependsWrapper-box">
                <button class="opacityLow"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M416 199.5h-91.4V64H187.4v135.5H96l160 158.1 160-158.1zM96 402.8V448h320v-45.2H96z"></path></svg>Ladda ner</button>
            </div>    
            <div class="gamepage-dependsWrapper-box">
                <button style="background-color: #343437; color: #fff;" class="opacityLow"><svg style="font-size: 13px;" stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32L0 64 0 368 0 480c0 17.7 14.3 32 32 32s32-14.3 32-32l0-128 64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30l0-247.7c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48l0-16z"></path></svg>Anm칛l</button>
            </div>    
        `)
        setTimeout(() => {
            $('.as')[0].pause(); 
        }, 100);
        selectGamePageContent(1)
        $(".gamepage-wrapper").show()
    }
}

function selectGamepageNavbar(type) {
    $(".gamepage-navbar-button").removeClass("gamepage-navbar-button-selected")
    $(`.gamepage-navbar-button[data-type="${type}"]`).addClass("gamepage-navbar-button-selected")

    if (type == "faq") {
        $(".gamepage-rightHandSide, .gamepage-tags, .gamepage-description, .gamepage-showcaseProfile").hide()
        $(".gamepage-faq").show()
    } else {
        $(".gamepage-faq").hide()
        $(".gamepage-rightHandSide, .gamepage-tags, .gamepage-description, .gamepage-showcaseProfile").show()
    }
}

$(document).on("click", ".gamepage-navbar-button", function () {
    selectGamepageNavbar($(this).attr("data-type"))
})

$(document).on("click", ".gamepage-footerWrapper-contents-box", function () {
    selectGamePageContent($(this).attr("data-id"))
})

$(document).on("click", ".selected-game", function () {
    openGamePage(currentGame)
})

$(document).on("click", ".gamepage-wrapper-close", function () {
    currentOpenedGame = "null";
    $("body").css("overflow-y", "auto")
    selectGamepageNavbar("oversikt")
    $("header").show()
    $(".gamepage-wrapper").hide()
})

function selectGamePageContent(id) {

    if (games[currentOpenedGame]) {

        const $video = $('.gamepage-contentScreen>video');
        const videoEl = $video[0];

        $(".gamepage-footerWrapper-contents-box")
            .removeClass("gamepage-footerWrapper-contents-box-selected");

        $(".pauseVideoShowcase").hide();
        $(".startVideoShowcase").show();

        $.each(games[currentOpenedGame].contents, function (k, v) {

            if (v == id) {

                if (isUrlVideo(k) == true) {

                    // Eski listenerlar캼 temizle
                    $video.off("play pause ended");

                    $(".gamepage-contentScreen>img").hide();
                    $video.attr("src", k).show();

                    // 游꿢 PLAY oldu릇nda icon de를릆ir
                    $video.on("play", function () {
                        $(`.gamepage-footerWrapper-contents-box[data-id="${id}"]`)
                            .find(".startVideoShowcase").hide()
                            .end()
                            .find(".pauseVideoShowcase").show();
                    });

                    // 游꿢 PAUSE veya ENDED oldu릇nda resetle
                    $video.on("pause ended", function () {
                        $(".pauseVideoShowcase").hide();
                        $(".startVideoShowcase").show();
                    });

                    videoEl.play();

                } else {

                    if (videoEl) {
                        videoEl.pause();
                        videoEl.currentTime = 0;
                    }

                    $video.hide();
                    $(".gamepage-contentScreen>img")
                        .attr("src", k)
                        .show();
                }

                $(`.gamepage-footerWrapper-contents-box[data-id="${id}"]`)
                    .addClass("gamepage-footerWrapper-contents-box-selected");

                return false;
            }

        });

    }

}


function smoothHorizontalScroll(element, distance) {
    const start = element.scrollLeft;
    const startTime = performance.now();

    function animate(currentTime) {
        const timeElapsed = currentTime - startTime;
        const progress = Math.min(timeElapsed / 300, 1);

        element.scrollLeft = start + distance * easeInOut(progress);

        if (progress < 1) {
            requestAnimationFrame(animate);
        }
    }

    function easeInOut(t) {
        return t < 0.5
            ? 2 * t * t
            : 1 - Math.pow(-2 * t + 2, 2) / 2;
    }

    requestAnimationFrame(animate);
}

$(document).on("click", ".gamepage-footerWrapper-leftButton", function () {
    const container = $(".gamepage-footerWrapper-contents")[0];
    smoothHorizontalScroll(container, -350);
});

$(document).on("click", ".gamepage-footerWrapper-rightButton", function () {
    const container = $(".gamepage-footerWrapper-contents")[0];
    smoothHorizontalScroll(container, 350);
});

function isUrlVideo(url) {
    const videoExtensions = [
        "mp4", "webm", "ogg", "mov", "mkv", "avi", "flv", "avif"
    ];
    try {
        const cleanUrl = url.split("?")[0].split("#")[0];
        const ext = cleanUrl.split(".").pop().toLowerCase();

        return videoExtensions.includes(ext);
    } catch {
        return false;
    }
}